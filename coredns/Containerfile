FROM registry.access.redhat.com/ubi10/ubi-minimal:10.1-1770052085@sha256:380da76bb8a69e333b6c11341d600f5d3aab9ee5b8c95ceb64aae2457f5c1c6e as builder

ARG VERSION=1.14.1

RUN microdnf install -y tar gzip && \
  curl -L https://github.com/coredns/coredns/releases/download/v${VERSION}/coredns_${VERSION}_linux_amd64.tgz | tar zxvf - && \
  ls -al coredns

FROM registry.access.redhat.com/ubi10/ubi-minimal:10.1-1770052085@sha256:380da76bb8a69e333b6c11341d600f5d3aab9ee5b8c95ceb64aae2457f5c1c6e

COPY --from=builder /coredns /usr/local/bin/coredns

WORKDIR /etc/coredns
ENTRYPOINT ["coredns"]
